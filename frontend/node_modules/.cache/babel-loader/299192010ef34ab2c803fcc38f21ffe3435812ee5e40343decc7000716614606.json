{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"config-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_divider = _resolveComponent(\"el-divider\");\n  const _component_el_switch = _resolveComponent(\"el-switch\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_option = _resolveComponent(\"el-option\");\n  const _component_el_select = _resolveComponent(\"el-select\");\n  const _component_el_checkbox = _resolveComponent(\"el-checkbox\");\n  const _component_el_checkbox_group = _resolveComponent(\"el-checkbox-group\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  const _component_el_collapse_item = _resolveComponent(\"el-collapse-item\");\n  const _component_el_collapse = _resolveComponent(\"el-collapse\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[28] || (_cache[28] = _createElementVNode(\"h2\", {\n    class: \"config-title\"\n  }, \"XSS防御配置\", -1 /* HOISTED */)), _createVNode(_component_el_card, null, {\n    header: _withCtx(() => _cache[10] || (_cache[10] = [_createElementVNode(\"div\", {\n      class: \"card-header\"\n    }, [_createElementVNode(\"h3\", null, \"防御策略配置\")], -1 /* HOISTED */)])),\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      model: $setup.config,\n      \"label-width\": \"180px\",\n      ref: \"configForm\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_divider, {\n        \"content-position\": \"left\"\n      }, {\n        default: _withCtx(() => _cache[11] || (_cache[11] = [_createTextVNode(\"输入验证\")])),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"启用输入验证\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.config.enableInputValidation,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.config.enableInputValidation = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), $setup.config.enableInputValidation ? (_openBlock(), _createBlock(_component_el_form_item, {\n        key: 0,\n        label: \"验证级别\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_select, {\n          modelValue: $setup.config.inputValidationLevel,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.config.inputValidationLevel = $event),\n          style: {\n            \"width\": \"100%\"\n          }\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_option, {\n            label: \"低 - 仅过滤基本XSS模式\",\n            value: \"low\"\n          }), _createVNode(_component_el_option, {\n            label: \"中 - 过滤常见XSS攻击向量\",\n            value: \"medium\"\n          }), _createVNode(_component_el_option, {\n            label: \"高 - 严格过滤所有可疑输入\",\n            value: \"high\"\n          })]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })) : _createCommentVNode(\"v-if\", true), _createVNode(_component_el_divider, {\n        \"content-position\": \"left\"\n      }, {\n        default: _withCtx(() => _cache[12] || (_cache[12] = [_createTextVNode(\"输出编码\")])),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"启用输出编码\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.config.enableOutputEncoding,\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.config.enableOutputEncoding = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), $setup.config.enableOutputEncoding ? (_openBlock(), _createBlock(_component_el_form_item, {\n        key: 1,\n        label: \"编码上下文\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_checkbox_group, {\n          modelValue: $setup.config.encodingContexts,\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.config.encodingContexts = $event)\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_checkbox, {\n            label: \"html\"\n          }, {\n            default: _withCtx(() => _cache[13] || (_cache[13] = [_createTextVNode(\"HTML上下文\")])),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_checkbox, {\n            label: \"attribute\"\n          }, {\n            default: _withCtx(() => _cache[14] || (_cache[14] = [_createTextVNode(\"HTML属性上下文\")])),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_checkbox, {\n            label: \"javascript\"\n          }, {\n            default: _withCtx(() => _cache[15] || (_cache[15] = [_createTextVNode(\"JavaScript上下文\")])),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_checkbox, {\n            label: \"url\"\n          }, {\n            default: _withCtx(() => _cache[16] || (_cache[16] = [_createTextVNode(\"URL上下文\")])),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })) : _createCommentVNode(\"v-if\", true), _createVNode(_component_el_divider, {\n        \"content-position\": \"left\"\n      }, {\n        default: _withCtx(() => _cache[17] || (_cache[17] = [_createTextVNode(\"内容安全策略 (CSP)\")])),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"启用CSP\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.config.enableCsp,\n          \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.config.enableCsp = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), $setup.config.enableCsp ? (_openBlock(), _createBlock(_component_el_form_item, {\n        key: 2,\n        label: \"CSP策略\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $setup.config.cspPolicy,\n          \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.config.cspPolicy = $event),\n          type: \"textarea\",\n          rows: 3,\n          placeholder: \"输入CSP策略，例如：default-src 'self'; script-src 'self'\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })) : _createCommentVNode(\"v-if\", true), _createVNode(_component_el_form_item, {\n        label: \"CSP报告模式\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.config.cspReportOnly,\n          \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $setup.config.cspReportOnly = $event),\n          disabled: !$setup.config.enableCsp\n        }, null, 8 /* PROPS */, [\"modelValue\", \"disabled\"]), _cache[18] || (_cache[18] = _createElementVNode(\"span\", {\n          class: \"hint-text\"\n        }, \"开启后，浏览器只会报告违规而不会阻止内容\", -1 /* HOISTED */))]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_divider, {\n        \"content-position\": \"left\"\n      }, {\n        default: _withCtx(() => _cache[19] || (_cache[19] = [_createTextVNode(\"Cookie安全\")])),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"启用HttpOnly\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.config.enableHttpOnly,\n          \"onUpdate:modelValue\": _cache[7] || (_cache[7] = $event => $setup.config.enableHttpOnly = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"]), _cache[20] || (_cache[20] = _createElementVNode(\"span\", {\n          class: \"hint-text\"\n        }, \"防止JavaScript访问Cookie\", -1 /* HOISTED */))]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"启用Secure标志\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.config.enableSecure,\n          \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => $setup.config.enableSecure = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"]), _cache[21] || (_cache[21] = _createElementVNode(\"span\", {\n          class: \"hint-text\"\n        }, \"仅通过HTTPS发送Cookie\", -1 /* HOISTED */))]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"启用SameSite\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_select, {\n          modelValue: $setup.config.sameSite,\n          \"onUpdate:modelValue\": _cache[9] || (_cache[9] = $event => $setup.config.sameSite = $event),\n          style: {\n            \"width\": \"100%\"\n          }\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_option, {\n            label: \"None - 不启用SameSite\",\n            value: \"None\"\n          }), _createVNode(_component_el_option, {\n            label: \"Lax - 允许导航到目标网址的Get请求\",\n            value: \"Lax\"\n          }), _createVNode(_component_el_option, {\n            label: \"Strict - 仅允许同站点请求\",\n            value: \"Strict\"\n          })]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_divider), _createVNode(_component_el_form_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"primary\",\n          onClick: $setup.saveConfig,\n          loading: $setup.isLoading\n        }, {\n          default: _withCtx(() => _cache[22] || (_cache[22] = [_createTextVNode(\"保存配置\")])),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"loading\"]), _createVNode(_component_el_button, {\n          onClick: $setup.resetConfig\n        }, {\n          default: _withCtx(() => _cache[23] || (_cache[23] = [_createTextVNode(\"重置\")])),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_card, {\n    class: \"tips-card\"\n  }, {\n    header: _withCtx(() => _cache[24] || (_cache[24] = [_createElementVNode(\"div\", {\n      class: \"card-header\"\n    }, [_createElementVNode(\"h3\", null, \"防御策略提示\")], -1 /* HOISTED */)])),\n    default: _withCtx(() => [_createVNode(_component_el_collapse, {\n      accordion: \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_collapse_item, {\n        title: \"输入验证最佳实践\",\n        name: \"1\"\n      }, {\n        default: _withCtx(() => _cache[25] || (_cache[25] = [_createElementVNode(\"div\", null, [_createElementVNode(\"p\", null, \"输入验证是防御XSS攻击的第一道防线，应该根据具体场景和数据类型应用不同的验证规则：\"), _createElementVNode(\"ul\", null, [_createElementVNode(\"li\", null, \"对于纯数字输入，使用正则表达式确保只接受数字\"), _createElementVNode(\"li\", null, \"对于URL，验证协议是否为http/https，避免javascript:伪协议\"), _createElementVNode(\"li\", null, \"对于富文本内容，使用白名单方法限制允许的HTML标签和属性\")])], -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_collapse_item, {\n        title: \"输出编码说明\",\n        name: \"2\"\n      }, {\n        default: _withCtx(() => _cache[26] || (_cache[26] = [_createElementVNode(\"div\", null, [_createElementVNode(\"p\", null, \"根据输出上下文选择合适的编码方式：\"), _createElementVNode(\"ul\", null, [_createElementVNode(\"li\", null, \"HTML上下文：将<, >, &, \\\", '等字符转换为对应的HTML实体\"), _createElementVNode(\"li\", null, \"HTML属性上下文：除了HTML编码外，还需要对引号进行特殊处理\"), _createElementVNode(\"li\", null, \"JavaScript上下文：使用\\\\uXXXX Unicode转义序列\"), _createElementVNode(\"li\", null, \"URL上下文：使用encodeURIComponent进行编码\")])], -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_collapse_item, {\n        title: \"CSP配置示例\",\n        name: \"3\"\n      }, {\n        default: _withCtx(() => _cache[27] || (_cache[27] = [_createElementVNode(\"div\", null, [_createElementVNode(\"p\", null, \"内容安全策略(CSP)常见指令：\"), _createElementVNode(\"ul\", null, [_createElementVNode(\"li\", null, [_createElementVNode(\"code\", null, \"default-src 'self';\"), _createTextVNode(\" - 默认只允许加载同源资源\")]), _createElementVNode(\"li\", null, [_createElementVNode(\"code\", null, \"script-src 'self';\"), _createTextVNode(\" - 脚本只能从同源加载\")]), _createElementVNode(\"li\", null, [_createElementVNode(\"code\", null, \"style-src 'self';\"), _createTextVNode(\" - 样式表只能从同源加载\")]), _createElementVNode(\"li\", null, [_createElementVNode(\"code\", null, \"img-src 'self' data:;\"), _createTextVNode(\" - 图片可以从同源和data URI加载\")]), _createElementVNode(\"li\", null, [_createElementVNode(\"code\", null, \"connect-src 'self';\"), _createTextVNode(\" - XHR, WebSockets和EventSource只能连接到同源\")])]), _createElementVNode(\"p\", null, [_createTextVNode(\"推荐配置：\"), _createElementVNode(\"code\", null, \"default-src 'self'; script-src 'self'; object-src 'none';\")])], -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createVNode","_component_el_card","header","_withCtx","_cache","default","_component_el_form","model","$setup","config","ref","_component_el_divider","_createTextVNode","_","_component_el_form_item","label","_component_el_switch","modelValue","enableInputValidation","$event","_createBlock","key","_component_el_select","inputValidationLevel","style","_component_el_option","value","_createCommentVNode","enableOutputEncoding","_component_el_checkbox_group","encodingContexts","_component_el_checkbox","enableCsp","_component_el_input","cspPolicy","type","rows","placeholder","cspReportOnly","disabled","enableHttpOnly","enableSecure","sameSite","_component_el_button","onClick","saveConfig","loading","isLoading","resetConfig","_component_el_collapse","accordion","_component_el_collapse_item","title","name"],"sources":["D:\\Desktop\\AI接单项目\\已完成\\20250321-WX-WEB-01\\xss-defense-system\\xss-defense-demo\\frontend\\src\\views\\DefenseConfig.vue"],"sourcesContent":["<template>\r\n  <div class=\"config-container\">\r\n    <h2 class=\"config-title\">XSS防御配置</h2>\r\n\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <h3>防御策略配置</h3>\r\n        </div>\r\n      </template>\r\n\r\n      <el-form :model=\"config\" label-width=\"180px\" ref=\"configForm\">\r\n        <el-divider content-position=\"left\">输入验证</el-divider>\r\n\r\n        <el-form-item label=\"启用输入验证\">\r\n          <el-switch v-model=\"config.enableInputValidation\" />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"验证级别\" v-if=\"config.enableInputValidation\">\r\n          <el-select v-model=\"config.inputValidationLevel\" style=\"width: 100%\">\r\n            <el-option label=\"低 - 仅过滤基本XSS模式\" value=\"low\" />\r\n            <el-option label=\"中 - 过滤常见XSS攻击向量\" value=\"medium\" />\r\n            <el-option label=\"高 - 严格过滤所有可疑输入\" value=\"high\" />\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <el-divider content-position=\"left\">输出编码</el-divider>\r\n\r\n        <el-form-item label=\"启用输出编码\">\r\n          <el-switch v-model=\"config.enableOutputEncoding\" />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"编码上下文\" v-if=\"config.enableOutputEncoding\">\r\n          <el-checkbox-group v-model=\"config.encodingContexts\">\r\n            <el-checkbox label=\"html\">HTML上下文</el-checkbox>\r\n            <el-checkbox label=\"attribute\">HTML属性上下文</el-checkbox>\r\n            <el-checkbox label=\"javascript\">JavaScript上下文</el-checkbox>\r\n            <el-checkbox label=\"url\">URL上下文</el-checkbox>\r\n          </el-checkbox-group>\r\n        </el-form-item>\r\n\r\n        <el-divider content-position=\"left\">内容安全策略 (CSP)</el-divider>\r\n\r\n        <el-form-item label=\"启用CSP\">\r\n          <el-switch v-model=\"config.enableCsp\" />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"CSP策略\" v-if=\"config.enableCsp\">\r\n          <el-input\r\n            v-model=\"config.cspPolicy\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"输入CSP策略，例如：default-src 'self'; script-src 'self'\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"CSP报告模式\">\r\n          <el-switch v-model=\"config.cspReportOnly\" :disabled=\"!config.enableCsp\" />\r\n          <span class=\"hint-text\">开启后，浏览器只会报告违规而不会阻止内容</span>\r\n        </el-form-item>\r\n\r\n        <el-divider content-position=\"left\">Cookie安全</el-divider>\r\n\r\n        <el-form-item label=\"启用HttpOnly\">\r\n          <el-switch v-model=\"config.enableHttpOnly\" />\r\n          <span class=\"hint-text\">防止JavaScript访问Cookie</span>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"启用Secure标志\">\r\n          <el-switch v-model=\"config.enableSecure\" />\r\n          <span class=\"hint-text\">仅通过HTTPS发送Cookie</span>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"启用SameSite\">\r\n          <el-select v-model=\"config.sameSite\" style=\"width: 100%\">\r\n            <el-option label=\"None - 不启用SameSite\" value=\"None\" />\r\n            <el-option label=\"Lax - 允许导航到目标网址的Get请求\" value=\"Lax\" />\r\n            <el-option label=\"Strict - 仅允许同站点请求\" value=\"Strict\" />\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <el-divider></el-divider>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"saveConfig\" :loading=\"isLoading\">保存配置</el-button>\r\n          <el-button @click=\"resetConfig\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n\r\n    <el-card class=\"tips-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <h3>防御策略提示</h3>\r\n        </div>\r\n      </template>\r\n\r\n      <el-collapse accordion>\r\n        <el-collapse-item title=\"输入验证最佳实践\" name=\"1\">\r\n          <div>\r\n            <p>输入验证是防御XSS攻击的第一道防线，应该根据具体场景和数据类型应用不同的验证规则：</p>\r\n            <ul>\r\n              <li>对于纯数字输入，使用正则表达式确保只接受数字</li>\r\n              <li>对于URL，验证协议是否为http/https，避免javascript:伪协议</li>\r\n              <li>对于富文本内容，使用白名单方法限制允许的HTML标签和属性</li>\r\n            </ul>\r\n          </div>\r\n        </el-collapse-item>\r\n\r\n        <el-collapse-item title=\"输出编码说明\" name=\"2\">\r\n          <div>\r\n            <p>根据输出上下文选择合适的编码方式：</p>\r\n            <ul>\r\n              <li>HTML上下文：将&lt;, &gt;, &amp;, &quot;, &#39;等字符转换为对应的HTML实体</li>\r\n              <li>HTML属性上下文：除了HTML编码外，还需要对引号进行特殊处理</li>\r\n              <li>JavaScript上下文：使用\\uXXXX Unicode转义序列</li>\r\n              <li>URL上下文：使用encodeURIComponent进行编码</li>\r\n            </ul>\r\n          </div>\r\n        </el-collapse-item>\r\n\r\n        <el-collapse-item title=\"CSP配置示例\" name=\"3\">\r\n          <div>\r\n            <p>内容安全策略(CSP)常见指令：</p>\r\n            <ul>\r\n              <li><code>default-src 'self';</code> - 默认只允许加载同源资源</li>\r\n              <li><code>script-src 'self';</code> - 脚本只能从同源加载</li>\r\n              <li><code>style-src 'self';</code> - 样式表只能从同源加载</li>\r\n              <li><code>img-src 'self' data:;</code> - 图片可以从同源和data URI加载</li>\r\n              <li><code>connect-src 'self';</code> - XHR, WebSockets和EventSource只能连接到同源</li>\r\n            </ul>\r\n            <p>推荐配置：<code>default-src 'self'; script-src 'self'; object-src 'none';</code></p>\r\n          </div>\r\n        </el-collapse-item>\r\n      </el-collapse>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, onMounted, computed } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nconst store = useStore()\r\nconst isLoading = computed(() => store.state.isLoading)\r\n\r\n// 配置表单\r\nconst config = reactive({\r\n  // 输入验证\r\n  enableInputValidation: true,\r\n  inputValidationLevel: 'medium',\r\n\r\n  // 输出编码\r\n  enableOutputEncoding: true,\r\n  encodingContexts: ['html', 'attribute'],\r\n\r\n  // CSP\r\n  enableCsp: true,\r\n  cspPolicy: \"default-src 'self'; script-src 'self'; object-src 'none';\",\r\n  cspReportOnly: false,\r\n\r\n  // Cookie安全\r\n  enableHttpOnly: true,\r\n  enableSecure: true,\r\n  sameSite: 'Lax'\r\n})\r\n\r\n// 加载配置\r\nconst loadConfig = async () => {\r\n  try {\r\n    // 实际应用中应从后端获取\r\n    // const response = await store.dispatch('getDefenseConfig')\r\n    // Object.assign(config, response.data)\r\n\r\n    // 这里使用Store中的配置\r\n    const storeConfig = store.getters.getDefenseConfig\r\n    Object.assign(config, {\r\n      enableInputValidation: storeConfig.enableInputValidation,\r\n      enableOutputEncoding: storeConfig.enableOutputEncoding,\r\n      enableCsp: storeConfig.enableCsp,\r\n      cspPolicy: storeConfig.cspPolicy\r\n    })\r\n  } catch (error) {\r\n    console.error('Failed to load config:', error)\r\n    ElMessage.error('加载配置失败')\r\n  }\r\n}\r\n\r\n// 保存配置\r\nconst saveConfig = async () => {\r\n  try {\r\n    // 实际应用中应调用API保存配置\r\n    // await store.dispatch('saveDefenseConfig', config)\r\n\r\n    // 这里直接更新Store\r\n    store.commit('SET_DEFENSE_CONFIG', {\r\n      enableInputValidation: config.enableInputValidation,\r\n      enableOutputEncoding: config.enableOutputEncoding,\r\n      enableCsp: config.enableCsp,\r\n      cspPolicy: config.cspPolicy\r\n    })\r\n\r\n    ElMessage.success('配置已保存')\r\n  } catch (error) {\r\n    console.error('Failed to save config:', error)\r\n    ElMessage.error('保存配置失败')\r\n  }\r\n}\r\n\r\n// 重置配置\r\nconst resetConfig = () => {\r\n  Object.assign(config, {\r\n    enableInputValidation: true,\r\n    inputValidationLevel: 'medium',\r\n    enableOutputEncoding: true,\r\n    encodingContexts: ['html', 'attribute'],\r\n    enableCsp: true,\r\n    cspPolicy: \"default-src 'self'; script-src 'self'; object-src 'none';\",\r\n    cspReportOnly: false,\r\n    enableHttpOnly: true,\r\n    enableSecure: true,\r\n    sameSite: 'Lax'\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  loadConfig()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.config-container {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n}\r\n\r\n.config-title {\r\n  margin-top: 20px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.hint-text {\r\n  font-size: 0.9em;\r\n  color: #909399;\r\n  margin-left: 10px;\r\n}\r\n\r\n.tips-card {\r\n  margin-top: 20px;\r\n}\r\n\r\ncode {\r\n  background-color: #f5f7fa;\r\n  padding: 2px 4px;\r\n  border-radius: 4px;\r\n  font-family: monospace;\r\n}\r\n\r\nul {\r\n  margin-top: 10px;\r\n  padding-left: 20px;\r\n}\r\n\r\nli {\r\n  margin-bottom: 5px;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}