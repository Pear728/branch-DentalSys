{"ast":null,"code":"/**\r\n * 安全HTML渲染指令 - 用于防止XSS攻击\r\n */\n\nconst sanitizeHtml = html => {\n  // 简单的HTML清理函数\n  if (!html) return '';\n\n  // 替换可能导致XSS的常见模式\n  return html.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/`/g, '&#96;').replace(/\\(/g, '&#40;').replace(/\\)/g, '&#41;').replace(/javascript:/gi, '').replace(/on\\w+=/gi, '');\n};\nexport const SafeHtmlDirective = {\n  beforeMount(el, binding) {\n    el.innerHTML = sanitizeHtml(binding.value);\n  },\n  updated(el, binding) {\n    el.innerHTML = sanitizeHtml(binding.value);\n  }\n};\n\n// 导出净化函数供其他组件使用\nexport const sanitize = sanitizeHtml;","map":{"version":3,"names":["sanitizeHtml","html","replace","SafeHtmlDirective","beforeMount","el","binding","innerHTML","value","updated","sanitize"],"sources":["D:/Desktop/AI接单项目/进行中/20250321-WX-WEB-01/工作文件/xss-defense-system/frontend/src/directives/safeHtml.js"],"sourcesContent":["/**\r\n * 安全HTML渲染指令 - 用于防止XSS攻击\r\n */\r\n\r\nconst sanitizeHtml = (html) => {\r\n  // 简单的HTML清理函数\r\n  if (!html) return '';\r\n  \r\n  // 替换可能导致XSS的常见模式\r\n  return html\r\n    .replace(/</g, '&lt;')\r\n    .replace(/>/g, '&gt;')\r\n    .replace(/\"/g, '&quot;')\r\n    .replace(/'/g, '&#39;')\r\n    .replace(/`/g, '&#96;')\r\n    .replace(/\\(/g, '&#40;')\r\n    .replace(/\\)/g, '&#41;')\r\n    .replace(/javascript:/gi, '')\r\n    .replace(/on\\w+=/gi, '');\r\n};\r\n\r\nexport const SafeHtmlDirective = {\r\n  beforeMount(el, binding) {\r\n    el.innerHTML = sanitizeHtml(binding.value);\r\n  },\r\n  updated(el, binding) {\r\n    el.innerHTML = sanitizeHtml(binding.value);\r\n  }\r\n};\r\n\r\n// 导出净化函数供其他组件使用\r\nexport const sanitize = sanitizeHtml; "],"mappings":"AAAA;AACA;AACA;;AAEA,MAAMA,YAAY,GAAIC,IAAI,IAAK;EAC7B;EACA,IAAI,CAACA,IAAI,EAAE,OAAO,EAAE;;EAEpB;EACA,OAAOA,IAAI,CACRC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CACrBA,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CACrBA,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CACvBA,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CACtBA,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CACtBA,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,CACvBA,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,CACvBA,OAAO,CAAC,eAAe,EAAE,EAAE,CAAC,CAC5BA,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;AAC5B,CAAC;AAED,OAAO,MAAMC,iBAAiB,GAAG;EAC/BC,WAAWA,CAACC,EAAE,EAAEC,OAAO,EAAE;IACvBD,EAAE,CAACE,SAAS,GAAGP,YAAY,CAACM,OAAO,CAACE,KAAK,CAAC;EAC5C,CAAC;EACDC,OAAOA,CAACJ,EAAE,EAAEC,OAAO,EAAE;IACnBD,EAAE,CAACE,SAAS,GAAGP,YAAY,CAACM,OAAO,CAACE,KAAK,CAAC;EAC5C;AACF,CAAC;;AAED;AACA,OAAO,MAAME,QAAQ,GAAGV,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}